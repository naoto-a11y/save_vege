<div class="container-fluid px-5 mx-5 my-4">
  <div class="row">
    <!-- サイドバー：左 -->
    <div class="col-3">
      <%= render 'share/info', farmer: @farmer %>
      <%= link_to reservations_path, class: "btn btn-outline-dark w-100 my-2" do %>
        予約一覧（<%= @reservation_count %>）
      <% end %>
    </div>

    <!-- メインコンテンツ：右 -->
    <div class="col-9">
      <div class="row">
        <!-- 左：画像 -->
        <div class="col-5">
          <%= image_tag @item.get_image, class: "img-fluid" %>
        </div>

        <!-- 右：商品情報 -->
        <div class="col-7">
          <h2><%= @item.name %></h2>
          <p class="my-4"><%= @item.introduction %></p>
          <p class="my-4 h4">￥<%= number_to_currency(@item.price) %>（税込）</p>
          生産者： <%= @item.farmer.last_name %>さん
          
        </div>
      </div>

      <!-- コメント一覧 -->
      <div class="mt-5 ml-5">
        <h4>コメント一覧</h4>
        <% @comments.each do |comment| %>
          <div class="ml-5 mt-4">
            <%= image_tag comment.sender.get_profile_image, size: "40x40", class: "rounded-circle me-2" %>
            <% if comment.sender_type == "Customer" %>
              <strong><%= comment.sender.last_name %>（消費者）</strong>
            <% elsif comment.sender_type == "Farmer" %>
              <strong><%= comment.sender.last_name %>（農家）</strong>
            <% end %>
            <div class="d-flex justify-content-between align-items-center mb-3 mr-5">
              <p class="mb-0"><%= comment.comment %></p>
              <%= link_to "削除する", item_comment_path(@item, comment), method: :delete, class: "btn btn-outline-dark mr-5" %>
            </div>
          </div>
        <% end %>
        <div class="mr-5 pr-5">
          <%= form_with model: [@item, @comment], local: true do |f| %>
            <div class="mb-3">
              <%= f.text_area :comment, class: "form-control", rows: 3, placeholder: "コメントを入力してください" %>
            </div>
            <%= f.submit "投稿", class: "btn btn-outline-dark" %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>


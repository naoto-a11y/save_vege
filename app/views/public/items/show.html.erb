<div class="container-fluid px-5 mx-5 my-4">
  <div class="row">
    <!-- „Çµ„Ç§„Éâ„Éê„ÉºÔºöÂ∑¶ -->
    <div class="col-3">
      <% if customer_signed_in? %>
        <%= render 'share/info', customer: @customer %>
        <%= link_to reservations_path, class: "btn btn-outline-dark w-100 my-2" do %>
          ‰∫àÁ¥Ñ‰∏ÄË¶ß(<%= @reservations.count %>)
        <% end %>
      <% end %>
      <%= render 'public/tags/tag', tags: @tags %>
    </div>

    <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑÔºöÂè≥ -->
    <div class="col-8 px-5 mx-3">
      <div class="card shadow-sm p-4 mb-4 w-100">
        <div class="d-flex justify-content-between">
          <!-- Â∑¶ÔºöÁîªÂÉè -->
          <div class="ml-5 pl-5">
            <%= image_tag @item.get_image, class: "img-fluid rounded mb-3", style: "width: 450px; height: 350px; object-fit: cover;" %>
          </div>

          <!-- Âè≥ÔºöÂïÜÂìÅÊÉÖÂ†± -->
          <!-- Âè≥Á´Ø„Å´ÂïÜÂìÅÊÉÖÂ†± -->
          <div class="mr-5 pr-5">
            <h1 class="mb-3 fw-bold"><%= @item.name %></h1>
            <p class="fs-5 mb-3"><%= @item.introduction %></p>
            <p class="h4 text-success mb-3">Ôø•<%= number_with_delimiter(@item.price) %>ÔºàÁ®éËæºÔºâ</p>
            <p class="fs-5 text-danger mb-3">
              <% if customer_signed_in? %>
                <% if current_customer.favorited?(@item) %>
                  <% favorite = current_customer.favorite_for(@item) %>
                  <%= link_to "‚ù§Ô∏è #{@item.favorites.count}", favorite_path(@item.id), method: :delete %>
                <% else %>
                  <%= link_to "‚ô° #{@item.favorites.count}", favorites_path(item_id: @item.id), method: :post %>
                <% end %>
              <% else %>
                ‚ù§Ô∏è<%= @item.favorites.count %>
              <% end %>
            </p>
            <p>
              <% @item.tags.each do |tag| %>
                üîñ<%= tag.tag_name %>
              <% end %>
            </p><br>
            <% if customer_signed_in? %>
              <% if current_customer.reserved_item?(@item) %>
                <%= link_to "DM„Åô„Çã",dm_room_path(@reservation.dm_room.id), class: "btn btn-outline-primary" %><br>
              <% else %>
                <%= form_with model: @reservation, url: item_reservations_path(@item), method: :post, local: true do |f| %>
                  <div class="mb-3">
                  <%= f.label :reserved_date, "‰∫àÁ¥ÑÊó•„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ", class: "form-label" %>
                  <%= f.select :reserved_date, 
                        @item.available_slots.map { |date| [date.available_date.strftime('%Y/%m/%d'), date.available_date] },
                        { prompt: "ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ" },
                        class: "form-select" %>
                  </div>
                  <%= f.submit "‰∫àÁ¥Ñ„Åô„Çã", class: "btn btn-outline-dark" %>
                <% end %>
              <% end %>
            <% end %>
            ÁîüÁî£ËÄÖÔºö<%= link_to farmer_path(@item.farmer) do %>
              <%= @item.farmer.last_name %>
            <% end %>„Åï„Çì
            
            <% if customer_signed_in? %>
              <% unless current_customer.following?(@item.farmer) %>
                <%= link_to "„Éï„Ç©„É≠„Éº„Åô„Çã", farmer_follow_path(@item.farmer.id), method: :post, class: "btn btn-outline-dark ml-3" %>
              <% else %>
                <%= link_to "„Éï„Ç©„É≠„ÉºËß£Èô§", farmer_follow_path(@item.farmer.id,), method: :delete, class: "btn btn-outline-dark ml-3" %>
              <% end %>
            <% end %>
          </div>
        </div>
      </div>
      <%= render 'public/comments/index', comments: @comments, item: @item, comment: @comment %>
    </div>
  </div>
</div>


